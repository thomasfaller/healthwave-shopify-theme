/** BC Recently Viewed Products By BoostCommerce - boostcommerce.net. Please don't modify or unzip this content. It will be updated regularly **/
/** VERSION 0.0.2 **/
"use strict";var jQ=jQuery.noConflict(!0),BCRecentProduct=function(){this.settings={recentlyViewedEnable:!0,limit:8,pointer:0,name:"bcRecentProductCookie",config:{expires:365,path:"/",domain:window.location.hostname},showRecentProductLabel:!0,showRecentProductVendor:!0,recentProductSliderRange:5,isCollectionPage:!1,isProductPage:!1,showOnCollectionPage:!1,showOnProductPage:!1},this.translation={recentProductHeading:"Recently Viewed Products",saleLabel:"Sale",soldOutLabel:"Sold Out",fromLabel:"from"},this.selector={recentProductWrapperSelector:".bc-sf-recent-products-wrapper",recentProductSliderSelector:".bc-sf-recent-products.owl-carousel"},this.template={recentlyDefaultHtml:'<div class="bc-sf-filter-product-item bc-sf-filter-product-item-grid"><div class="bc-sf-filter-product-item-inner"><div class="bc-sf-filter-product-item-image"><a href="{{itemUrl}}">{{itemImages}}</a></div><div class="bc-sf-filter-product-item-label">{{itemLabels}}{{itemTagLabels}}</div><div class="bc-sf-filter-product-bottom"><a href="{{itemUrl}}" class="bc-sf-filter-product-item-title">{{itemTitle}}</a>{{itemVendor}}{{itemPrice}}</div></div></div>'}};function rvBuildImages(e){return'<img src="'+e.featured_image+'" class="bc-sf-filter-product-item-main-image" alt="'+e.title+'">'}function rvBuildLabels(e,t){var r=!e.available,i=e.compare_at_price_min>e.price_min,s="";return 1==t.settings.showRecentProductLabel&&(r&&(s+='<span class="soldout bc-sf-filter-label">'+t.translation.soldOutLabel+"</span>"),i&&(s+='<span class="sale bc-sf-filter-label">'+t.translation.saleLabel+"</span>")),s}function rvBuildTagLabels(e){showall=!1;var t="";if(1==bcRV.settings.showRecentProductLabel)if(showall){if(e.tags)for(i=0;i<data.product.length;i++)tag=e.tags[i],tag.indexOf("pfs:label")&&(t+='<span class="bc-sf-filter-label tag">'+tag.split("pfs:label-")[1]+"</span>")}else if(e.tags)for(i=e.tags.length-1;0<=i;i--)if(tag=e.tags[i],tag.indexOf("pfs:label")){t+='<span class="bc-sf-filter-label tag">'+tag.split("pfs:label-")[1]+"</span>";break}return t}function rvBuildVendor(e,t){var r="";return 1==t.settings.showRecentProductVendor&&(r+='<p class="bc-sf-filter-product-item-vendor">'+e.vendor+"</p>"),r}function rvBuildPrice(e,t){var r="",i=e.compare_at_price_min>e.price_min,s=e.price_min!=e.price_max;return r='<p class="bc-sf-filter-product-item-price">',i?(r+="<s>"+Shopify.formatMoney(e.compare_at_price_min)+"</s> ",r+='<span class="bc-sf-filter-product-item-sale-price">'+Shopify.formatMoney(e.price_min)+"</span>"):(s&&(r+=t.translation.fromLabel+" "),r+='<span class="bc-sf-filter-product-item-regular-price">'+Shopify.formatMoney(e.price_min)+"</span>"),r+="</p>"}BCRecentProduct.prototype.init=function(e,t){var r=this;r.rvPrepareParams(e,t),r.settings.recentlyViewedEnable&&(r.saveRecentProduct(),r.showRecentProducts(),r.recentProductInitCarousel(r.selector.recentProductSliderSelector,r.settings.recentProductSliderRange,!0,!0))},BCRecentProduct.prototype.rvPrepareParams=function(e,t){void 0===e||jQ.isEmptyObject(e)||this.rvPrepareFilterAppParams(e),void 0===t||jQ.isEmptyObject(t)||this.rvPrepareDevParams(t)},BCRecentProduct.prototype.rvPrepareFilterAppParams=function(e){var t=this;void 0!==e.recentlyViewed&&t.rvPrepareDevParams(e.recentlyViewed),void 0!==e.label&&void 0!==e.label&&"undefined"!==e.label.recentlyViewed&&(this.translation=t.mergeObjects(t.translation,e.label.recentlyViewed))},BCRecentProduct.prototype.rvPrepareDevParams=function(e){this.rvUpdateParams(e)},BCRecentProduct.prototype.rvUpdateParams=function(e){var t=this;void 0!==e&&(void 0!==e.settings&&(this.settings=t.mergeObjects(t.settings,e.settings)),void 0!==e.translation&&(this.translation=t.mergeObjects(t.translation,e.translation)),void 0!==e.template&&(this.template=t.mergeObjects(t.template,e.template)),void 0!==e.selector&&(this.selector=t.mergeObjects(t.selector,e.selector)))},BCRecentProduct.prototype.saveRecentProduct=function(){if(this.settings.isProductPage){var e=window.location.pathname.match(/\/products\/([a-z0-9\-]+)/)[1];null==jQ.cookie(this.settings.name)&&-1!==window.location.pathname.indexOf("/products/")&&jQ.cookie(this.settings.name,e,this.settings.config);var t=[];null!=jQ.cookie(this.settings.name)&&(t=jQ.cookie(this.settings.name).split(",")),-1==t.indexOf(e)&&(t.length>=this.settings.limit&&t.unshift,t.push(e)),0<t.length&&jQ.cookie(this.settings.name,t.join(","),this.settings.config)}},BCRecentProduct.prototype.checkShowRecentProducts=function(){var e=this;return!!(e.settings.showOnCollectionPage&&e.settings.isCollectionPage||e.settings.showOnProductPage&&e.settings.isProductPage)},BCRecentProduct.prototype.showRecentProducts=function(){var r=this;if(r.checkShowRecentProducts()){var e=[],i=this.settings;this.translation;if(void 0!==jQ.cookie(r.settings.name)&&""!=jQ.cookie(r.settings.name))e=jQ.cookie(r.settings.name).split(","),jQ(".bc-sf-recent-products-wrapper .bc-sf-recent-products").empty(),jQ.each(e.reverse(),function(e,t){if(i.pointer>=i.limit||""==t)return!1;"undefined"!=typeof bcsffilter&&r.settings.isCollectionPage?jQ.ajax({method:"GET",url:"/products/"+t+"?view=bc-sf-filter-json",success:function(e){var t=jQ(".bc-sf-recent-products-wrapper .bc-sf-recent-products"),r=bcsffilter.buildProductGridItem(JSON.parse(e),i.pointer);t.append(r)},error:function(){console.log("Failed to load recently viewed products")}}):jQ.getJSON("/products/"+t+".js",function(e){jQ(".bc-sf-recent-products-wrapper .bc-sf-recent-products").append(r.buildRecentProductItem(e))}),i.pointer+=1}),jQ(r.selector.recentProductWrapperSelector).prepend('<h2 class="bc-sf-recent-product-heading">'+r.translation.recentProductHeading+"</h2>")}},BCRecentProduct.prototype.buildRecentProductItem=function(e){var t=this,r=t.template.recentlyDefaultHtml;return r=(r=(r=(r=(r=(r=(r=r.replace(/{{itemTitle}}/g,e.title)).replace(/{{itemUrl}}/g,e.url)).replace(/{{itemLabels}}/g,rvBuildLabels(e,t))).replace(/{{itemTagLabels}}/g,rvBuildTagLabels(e))).replace(/{{itemImages}}/g,rvBuildImages(e))).replace(/{{itemPrice}}/g,rvBuildPrice(e,t))).replace(/{{itemVendor}}/g,rvBuildVendor(e,t))},BCRecentProduct.prototype.recentProductInitCarousel=function(e,t,r,i){0<jQ(e).length&&setTimeout(function(){jQ(e).owlCarousel({loop:i||!1,nav:r||!1,responsiveClass:!0,responsive:{0:{items:2},600:{items:2},1024:{items:3},1200:{items:t||5,loop:!1}}})},2e3)},BCRecentProduct.prototype.mergeObjects=function(t,r){for(var i in r)try{t[i]=r[i].constructor==Object?mergeObject(t[i],r[i]):r[i]}catch(e){t[i]=r[i]}return t};